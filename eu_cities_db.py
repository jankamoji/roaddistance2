# eu_cities_db.py
# EU Cities Database (100k+ population)
# Comprehensive database for all 27 EU Member States
# This file can be imported separately or embedded

from typing import Optional, Dict, Any

EU_CITIES_DB = {
    "DE": [  # 37 cities
        {"name": "Berlin", "lat": 52.520008, "lon": 13.404954, "pop": 3644826},
        {"name": "Hamburg", "lat": 53.550341, "lon": 10.000654, "pop": 1852405},
        {"name": "Munich", "lat": 48.135125, "lon": 11.581981, "pop": 1484541},
        {"name": "Cologne", "lat": 50.938361, "lon": 6.959974, "pop": 1097286},
        {"name": "Frankfurt", "lat": 50.110924, "lon": 8.682127, "pop": 746878},
        {"name": "Stuttgart", "lat": 48.775419, "lon": 9.182440, "pop": 623738},
        {"name": "Düsseldorf", "lat": 51.227144, "lon": 6.773602, "pop": 619294},
        {"name": "Dortmund", "lat": 51.514008, "lon": 7.465298, "pop": 587181},
        {"name": "Essen", "lat": 51.454513, "lon": 7.013345, "pop": 581760},
        {"name": "Leipzig", "lat": 51.339695, "lon": 12.373075, "pop": 608322},
        {"name": "Bremen", "lat": 53.074722, "lon": 8.237500, "pop": 563798},
        {"name": "Dresden", "lat": 51.050409, "lon": 13.737262, "pop": 555351},
        {"name": "Hanover", "lat": 52.375892, "lon": 9.735603, "pop": 543669},
        {"name": "Nuremberg", "lat": 49.451993, "lon": 11.076745, "pop": 518365},
        {"name": "Duisburg", "lat": 51.434344, "lon": 6.762779, "pop": 500602},
        {"name": "Bochum", "lat": 51.476086, "lon": 7.225381, "pop": 364760},
        {"name": "Wuppertal", "lat": 51.265430, "lon": 7.184368, "pop": 353798},
        {"name": "Bielefeld", "lat": 52.029444, "lon": 8.532222, "pop": 333216},
        {"name": "Bonn", "lat": 50.735556, "lon": 7.098889, "pop": 327913},
        {"name": "Münster", "lat": 51.961944, "lon": 7.628889, "pop": 314271},
        {"name": "Mannheim", "lat": 49.487613, "lon": 8.466038, "pop": 309370},
        {"name": "Karlsruhe", "lat": 49.006890, "lon": 8.387592, "pop": 308436},
        {"name": "Augsburg", "lat": 48.372114, "lon": 10.898268, "pop": 301143},
        {"name": "Wiesbaden", "lat": 50.082951, "lon": 8.240438, "pop": 287248},
        {"name": "Aachen", "lat": 50.776351, "lon": 6.083887, "pop": 265130},
        {"name": "Mönchengladbach", "lat": 51.156891, "lon": 6.396752, "pop": 256639},
        {"name": "Gelsenkirchen", "lat": 51.497916, "lon": 7.095960, "pop": 257620},
        {"name": "Freiburg", "lat": 47.995390, "lon": 7.842590, "pop": 230940},
        {"name": "Krefeld", "lat": 51.336667, "lon": 6.566667, "pop": 225881},
        {"name": "Kiel", "lat": 54.323181, "lon": 10.131850, "pop": 247744},
        {"name": "Magdeburg", "lat": 52.131028, "lon": 11.629182, "pop": 238679},
        {"name": "Oberhausen", "lat": 51.465148, "lon": 6.858169, "pop": 210751},
        {"name": "Rostock", "lat": 54.088333, "lon": 12.140833, "pop": 209191},
        {"name": "Mülheim an der Ruhr", "lat": 51.414219, "lon": 6.885137, "pop": 180620},
        {"name": "Saarbrücken", "lat": 49.233333, "lon": 6.983333, "pop": 180218},
        {"name": "Remscheid", "lat": 51.184545, "lon": 7.198220, "pop": 110040},
        {"name": "Recklinghausen", "lat": 51.610776, "lon": 7.197792, "pop": 109722},
    ],
    "PL": [  # 28 cities
        {"name": "Warsaw", "lat": 52.229676, "lon": 21.012229, "pop": 1863564},
        {"name": "Krakow", "lat": 50.049683, "lon": 19.944544, "pop": 804237},
        {"name": "Łódź", "lat": 51.779233, "lon": 19.447232, "pop": 672914},
        {"name": "Wrocław", "lat": 51.110093, "lon": 17.038632, "pop": 637075},
        {"name": "Poznań", "lat": 52.406374, "lon": 16.931992, "pop": 535830},
        {"name": "Gdańsk", "lat": 54.372158, "lon": 18.638453, "pop": 461865},
        {"name": "Szczecin", "lat": 53.429889, "lon": 14.552894, "pop": 395105},
        {"name": "Bydgoszcz", "lat": 53.123480, "lon": 18.007880, "pop": 355735},
        {"name": "Lublin", "lat": 51.246595, "lon": 22.566471, "pop": 336779},
        {"name": "Katowice", "lat": 50.264892, "lon": 19.023854, "pop": 299170},
        {"name": "Białystok", "lat": 53.132466, "lon": 23.168826, "pop": 295012},
        {"name": "Gdynia", "lat": 54.488170, "lon": 18.633274, "pop": 246316},
        {"name": "Częstochowa", "lat": 50.812328, "lon": 19.120853, "pop": 215815},
        {"name": "Radom", "lat": 51.402656, "lon": 21.143419, "pop": 209962},
        {"name": "Zabrze", "lat": 50.313156, "lon": 18.775308, "pop": 170784},
        {"name": "Kielce", "lat": 50.885833, "lon": 21.128333, "pop": 186396},
        {"name": "Gliwice", "lat": 50.288611, "lon": 18.677222, "pop": 174532},
        {"name": "Rybnik", "lat": 50.099444, "lon": 18.552778, "pop": 139832},
        {"name": "Dąbrowa Górnicza", "lat": 50.344444, "lon": 19.194167, "pop": 124416},
        {"name": "Tychy", "lat": 50.122500, "lon": 19.131667, "pop": 169610},
        {"name": "Bytom", "lat": 50.348333, "lon": 18.918333, "pop": 175136},
        {"name": "Toruń", "lat": 53.613889, "lon": 18.598333, "pop": 202340},
        {"name": "Piotrków Trybunalski", "lat": 51.398333, "lon": 19.698889, "pop": 119701},
        {"name": "Elbląg", "lat": 54.158889, "lon": 19.411389, "pop": 121353},
        {"name": "Chorzów", "lat": 50.294444, "lon": 18.951667, "pop": 110759},
        {"name": "Myślenice", "lat": 49.769167, "lon": 19.918056, "pop": 73530},
        {"name": "Slupsk", "lat": 54.466389, "lon": 17.022500, "pop": 92657},
        {"name": "Koszalin", "lat": 54.194167, "lon": 15.571667, "pop": 108235},
    ],
    "FR": [  # 32 cities
        {"name": "Paris", "lat": 48.856613, "lon": 2.352222, "pop": 2161000},
        {"name": "Marseille", "lat": 43.296387, "lon": 5.369780, "pop": 869815},
        {"name": "Lyon", "lat": 45.764043, "lon": 4.835659, "pop": 516092},
        {"name": "Toulouse", "lat": 43.604652, "lon": 1.444209, "pop": 479553},
        {"name": "Nice", "lat": 43.710173, "lon": 7.261953, "pop": 340017},
        {"name": "Nantes", "lat": 47.218371, "lon": -1.553621, "pop": 309346},
        {"name": "Strasbourg", "lat": 48.573405, "lon": 7.752111, "pop": 285121},
        {"name": "Montpellier", "lat": 43.610769, "lon": 3.876716, "pop": 285121},
        {"name": "Bordeaux", "lat": 44.841225, "lon": -0.580036, "pop": 261576},
        {"name": "Lille", "lat": 50.629250, "lon": 3.057256, "pop": 232566},
        {"name": "Rennes", "lat": 48.111148, "lon": -1.680198, "pop": 220050},
        {"name": "Toulon", "lat": 43.124228, "lon": 5.928139, "pop": 174697},
        {"name": "Reims", "lat": 49.258329, "lon": 4.031696, "pop": 180759},
        {"name": "Le Havre", "lat": 49.494369, "lon": 0.107883, "pop": 170098},
        {"name": "Rouen", "lat": 49.440258, "lon": 1.099369, "pop": 111557},
        {"name": "Saint-Étienne", "lat": 45.438333, "lon": 4.387222, "pop": 167101},
        {"name": "Grenoble", "lat": 45.188529, "lon": 5.724524, "pop": 161132},
        {"name": "Angers", "lat": 47.471667, "lon": -0.551667, "pop": 156639},
        {"name": "Dijon", "lat": 47.322047, "lon": 5.041480, "pop": 156084},
        {"name": "Nîmes", "lat": 43.836699, "lon": 4.360054, "pop": 150758},
        {"name": "Aix-en-Provence", "lat": 43.529742, "lon": 5.447427, "pop": 145957},
        {"name": "Brest", "lat": 48.390394, "lon": -4.486076, "pop": 140065},
        {"name": "Le Mans", "lat": 48.000278, "lon": 0.199389, "pop": 142436},
        {"name": "Clermont-Ferrand", "lat": 45.777222, "lon": 3.087222, "pop": 149265},
        {"name": "Villeurbanne", "lat": 45.768889, "lon": 4.872222, "pop": 149283},
        {"name": "Tours", "lat": 47.394144, "lon": 0.684161, "pop": 134834},
        {"name": "Nancy", "lat": 48.692054, "lon": 6.184417, "pop": 105331},
        {"name": "Amiens", "lat": 49.894667, "lon": 2.299167, "pop": 134388},
        {"name": "Perpignan", "lat": 42.698056, "lon": 2.893889, "pop": 118479},
        {"name": "Besançon", "lat": 47.238056, "lon": 6.024444, "pop": 115941},
        {"name": "Caen", "lat": 49.182778, "lon": -0.369722, "pop": 110857},
        {"name": "Limoges", "lat": 45.833333, "lon": 1.266667, "pop": 126323},
    ],
    "IT": [  # 26 cities
        {"name": "Rome", "lat": 41.902782, "lon": 12.496366, "pop": 2873494},
        {"name": "Milan", "lat": 45.465642, "lon": 9.185924, "pop": 1399000},
        {"name": "Naples", "lat": 40.852054, "lon": 14.268619, "pop": 910448},
        {"name": "Turin", "lat": 45.070312, "lon": 7.686856, "pop": 870456},
        {"name": "Palermo", "lat": 38.115556, "lon": 13.361389, "pop": 657224},
        {"name": "Genoa", "lat": 44.405648, "lon": 8.946256, "pop": 610307},
        {"name": "Bologna", "lat": 44.494887, "lon": 11.342616, "pop": 394321},
        {"name": "Florence", "lat": 43.769562, "lon": 11.255814, "pop": 382258},
        {"name": "Bari", "lat": 41.117268, "lon": 16.871871, "pop": 320823},
        {"name": "Catania", "lat": 37.502669, "lon": 15.087269, "pop": 307276},
        {"name": "Venice", "lat": 45.440847, "lon": 12.315515, "pop": 260520},
        {"name": "Verona", "lat": 45.438889, "lon": 10.993333, "pop": 258034},
        {"name": "Messina", "lat": 38.192592, "lon": 15.556389, "pop": 238997},
        {"name": "Padua", "lat": 45.406408, "lon": 11.876761, "pop": 211959},
        {"name": "Trieste", "lat": 45.650587, "lon": 13.780471, "pop": 202123},
        {"name": "Brescia", "lat": 45.538460, "lon": 10.211764, "pop": 193959},
        {"name": "Prato", "lat": 43.879394, "lon": 11.096689, "pop": 194537},
        {"name": "Taranto", "lat": 40.478333, "lon": 17.238889, "pop": 199041},
        {"name": "Reggio Calabria", "lat": 38.110556, "lon": 15.651111, "pop": 179753},
        {"name": "Modena", "lat": 44.646389, "lon": 10.926389, "pop": 184709},
        {"name": "Perugia", "lat": 43.111111, "lon": 12.388889, "pop": 168122},
        {"name": "Ravenna", "lat": 44.414444, "lon": 12.202778, "pop": 157838},
        {"name": "Rimini", "lat": 44.066389, "lon": 12.566389, "pop": 148365},
        {"name": "Salerno", "lat": 40.679722, "lon": 14.771111, "pop": 144322},
        {"name": "Foggia", "lat": 41.461667, "lon": 15.551667, "pop": 163452},
        {"name": "Lecce", "lat": 40.356389, "lon": 18.172500, "pop": 92577},
    ],
    "ES": [  # 29 cities
        {"name": "Madrid", "lat": 40.416775, "lon": -3.703790, "pop": 3266000},
        {"name": "Barcelona", "lat": 41.385064, "lon": 2.173403, "pop": 1620000},
        {"name": "Valencia", "lat": 39.469907, "lon": -0.376288, "pop": 791413},
        {"name": "Seville", "lat": 37.389092, "lon": -5.984459, "pop": 688711},
        {"name": "Zaragoza", "lat": 41.648823, "lon": -0.889085, "pop": 666880},
        {"name": "Málaga", "lat": 36.721261, "lon": -4.421266, "pop": 574654},
        {"name": "Murcia", "lat": 37.983810, "lon": -1.129730, "pop": 453258},
        {"name": "Palma", "lat": 39.569390, "lon": 2.650170, "pop": 416065},
        {"name": "Bilbao", "lat": 43.262985, "lon": -2.935013, "pop": 345821},
        {"name": "Alicante", "lat": 38.345996, "lon": -0.490686, "pop": 334887},
        {"name": "Córdoba", "lat": 37.888175, "lon": -4.779383, "pop": 325708},
        {"name": "Valladolid", "lat": 41.652251, "lon": -4.724532, "pop": 298412},
        {"name": "Vigo", "lat": 42.240599, "lon": -8.720727, "pop": 295364},
        {"name": "Gijón", "lat": 43.545261, "lon": -5.661926, "pop": 271780},
        {"name": "L'Hospitalet de Llobregat", "lat": 41.359967, "lon": 2.100280, "pop": 264923},
        {"name": "Granada", "lat": 37.177336, "lon": -3.598557, "pop": 232208},
        {"name": "Oviedo", "lat": 43.361914, "lon": -5.849389, "pop": 220020},
        {"name": "Badalona", "lat": 41.450000, "lon": 2.247741, "pop": 219547},
        {"name": "Cartagena", "lat": 37.605742, "lon": -0.986179, "pop": 216108},
        {"name": "Terrassa", "lat": 41.563211, "lon": 2.008787, "pop": 218535},
        {"name": "Jerez de la Frontera", "lat": 36.686683, "lon": -6.137324, "pop": 212876},
        {"name": "Sabadell", "lat": 41.548852, "lon": 2.108499, "pop": 211734},
        {"name": "Móstoles", "lat": 40.323493, "lon": -3.864966, "pop": 208841},
        {"name": "Alcalá de Henares", "lat": 40.482936, "lon": -3.363542, "pop": 195649},
        {"name": "Pamplona", "lat": 42.812526, "lon": -1.645775, "pop": 201653},
        {"name": "Fuenlabrada", "lat": 40.283889, "lon": -3.800000, "pop": 193586},
        {"name": "Almería", "lat": 36.834047, "lon": -2.463714, "pop": 200753},
        {"name": "Santander", "lat": 43.462306, "lon": -3.809980, "pop": 172221},
        {"name": "Leganés", "lat": 40.328027, "lon": -3.765593, "pop": 189861},
    ],
    "NL": [  # 28 cities
        {"name": "Amsterdam", "lat": 52.370216, "lon": 4.895168, "pop": 872680},
        {"name": "Rotterdam", "lat": 51.924420, "lon": 4.477733, "pop": 651446},
        {"name": "The Hague", "lat": 52.070498, "lon": 4.300700, "pop": 545163},
        {"name": "Utrecht", "lat": 52.090737, "lon": 5.121420, "pop": 357694},
        {"name": "Eindhoven", "lat": 51.441642, "lon": 5.469722, "pop": 234235},
        {"name": "Groningen", "lat": 53.219383, "lon": 6.566502, "pop": 232874},
        {"name": "Tilburg", "lat": 51.555510, "lon": 5.091470, "pop": 219800},
        {"name": "Almere", "lat": 52.370974, "lon": 5.214204, "pop": 211514},
        {"name": "Breda", "lat": 51.587100, "lon": 4.776000, "pop": 183873},
        {"name": "Nijmegen", "lat": 51.842520, "lon": 5.854550, "pop": 176731},
        {"name": "Apeldoorn", "lat": 52.211157, "lon": 5.969923, "pop": 163818},
        {"name": "Haarlem", "lat": 52.381169, "lon": 4.637070, "pop": 161265},
        {"name": "Arnhem", "lat": 51.985103, "lon": 5.898730, "pop": 159265},
        {"name": "Zaanstad", "lat": 52.457962, "lon": 4.751070, "pop": 156711},
        {"name": "Amersfoort", "lat": 52.155089, "lon": 5.387827, "pop": 156286},
        {"name": "Haarlemmermeer", "lat": 52.302850, "lon": 4.690769, "pop": 155235},
        {"name": "Enschede", "lat": 52.221537, "lon": 6.893662, "pop": 158986},
        {"name": "Dordrecht", "lat": 51.810000, "lon": 4.673890, "pop": 118654},
        {"name": "Leiden", "lat": 52.160114, "lon": 4.497010, "pop": 124899},
        {"name": "Zoetermeer", "lat": 52.057000, "lon": 4.493250, "pop": 125283},
        {"name": "Zwolle", "lat": 52.512495, "lon": 6.093844, "pop": 128821},
        {"name": "Ede", "lat": 52.032776, "lon": 5.658571, "pop": 117166},
        {"name": "Maastricht", "lat": 50.848333, "lon": 5.688889, "pop": 121565},
        {"name": "Sittard-Geleen", "lat": 51.002487, "lon": 5.869688, "pop": 91760},
        {"name": "Helmond", "lat": 51.475200, "lon": 5.661000, "pop": 92432},
        {"name": "Venlo", "lat": 51.370380, "lon": 6.168170, "pop": 101797},
        {"name": "Delft", "lat": 52.011577, "lon": 4.357068, "pop": 103588},
        {"name": "Alkmaar", "lat": 52.632381, "lon": 4.753375, "pop": 109436},
    ],
    # Additional countries - 21 more
    "BE": [
        {"name": "Brussels", "lat": 50.850340, "lon": 4.351710, "pop": 1212352},
        {"name": "Antwerp", "lat": 51.219448, "lon": 4.402464, "pop": 523248},
        {"name": "Ghent", "lat": 51.054342, "lon": 3.717424, "pop": 262219},
        {"name": "Charleroi", "lat": 50.411034, "lon": 4.444432, "pop": 201593},
        {"name": "Liège", "lat": 50.632557, "lon": 5.579666, "pop": 197355},
        {"name": "Bruges", "lat": 51.209348, "lon": 3.224700, "pop": 118284},
        {"name": "Namur", "lat": 50.465328, "lon": 4.867665, "pop": 110939},
        {"name": "Leuven", "lat": 50.881365, "lon": 4.716537, "pop": 101396},
    ],
    "AT": [
        {"name": "Vienna", "lat": 48.208174, "lon": 16.373819, "pop": 1897000},
        {"name": "Graz", "lat": 47.070714, "lon": 15.439504, "pop": 288806},
        {"name": "Linz", "lat": 48.306940, "lon": 14.285830, "pop": 204846},
        {"name": "Salzburg", "lat": 47.809490, "lon": 13.055010, "pop": 155021},
        {"name": "Innsbruck", "lat": 47.269212, "lon": 11.404102, "pop": 132110},
        {"name": "Klagenfurt", "lat": 46.622220, "lon": 14.305280, "pop": 101303},
    ],
    "CZ": [
        {"name": "Prague", "lat": 50.075538, "lon": 14.437800, "pop": 1309000},
        {"name": "Brno", "lat": 49.195061, "lon": 16.606836, "pop": 372578},
        {"name": "Ostrava", "lat": 49.833880, "lon": 18.283880, "pop": 290553},
        {"name": "Plzeň", "lat": 49.738411, "lon": 13.378116, "pop": 173659},
        {"name": "Liberec", "lat": 50.763056, "lon": 15.056389, "pop": 104266},
    ],
    "HU": [
        {"name": "Budapest", "lat": 47.497912, "lon": 19.040235, "pop": 1752286},
        {"name": "Debrecen", "lat": 47.530556, "lon": 21.630556, "pop": 200341},
        {"name": "Szeged", "lat": 46.252778, "lon": 20.141667, "pop": 160348},
        {"name": "Miskolc", "lat": 48.103519, "lon": 20.776111, "pop": 153000},
        {"name": "Pécs", "lat": 46.073056, "lon": 18.232222, "pop": 140234},
    ],
    "RO": [
        {"name": "Bucharest", "lat": 44.426767, "lon": 26.102538, "pop": 1830169},
        {"name": "Cluj-Napoca", "lat": 46.768585, "lon": 23.590415, "pop": 411379},
        {"name": "Timişoara", "lat": 45.755814, "lon": 21.230015, "pop": 319279},
        {"name": "Iaşi", "lat": 47.158889, "lon": 27.586389, "pop": 288121},
        {"name": "Constanța", "lat": 44.176111, "lon": 28.665278, "pop": 283872},
        {"name": "Craiova", "lat": 44.330329, "lon": 23.805522, "pop": 269506},
        {"name": "Braşov", "lat": 45.641053, "lon": 25.628441, "pop": 266199},
        {"name": "Ploiești", "lat": 44.948889, "lon": 25.582500, "pop": 223369},
    ],
    "GR": [
        {"name": "Athens", "lat": 37.983810, "lon": 23.727539, "pop": 3154001},
        {"name": "Thessaloniki", "lat": 40.640672, "lon": 22.927754, "pop": 325182},
        {"name": "Patras", "lat": 38.246453, "lon": 21.734402, "pop": 168099},
        {"name": "Heraklion", "lat": 35.338692, "lon": 25.131606, "pop": 173993},
    ],
    "PT": [
        {"name": "Lisbon", "lat": 38.722252, "lon": -9.139337, "pop": 505526},
        {"name": "Porto", "lat": 41.157944, "lon": -8.629105, "pop": 1688816},
        {"name": "Braga", "lat": 41.565250, "lon": -8.429870, "pop": 195938},
        {"name": "Covilhã", "lat": 40.284850, "lon": -7.498690, "pop": 117505},
    ],
    "SE": [
        {"name": "Stockholm", "lat": 59.329444, "lon": 18.068611, "pop": 975551},
        {"name": "Gothenburg", "lat": 57.708870, "lon": 11.974560, "pop": 644799},
        {"name": "Malmö", "lat": 55.604981, "lon": 12.994850, "pop": 347949},
        {"name": "Uppsala", "lat": 59.861405, "lon": 17.640148, "pop": 230767},
        {"name": "Västerås", "lat": 59.609869, "lon": 16.539127, "pop": 127948},
        {"name": "Örebro", "lat": 59.271088, "lon": 15.207284, "pop": 130676},
        {"name": "Linköping", "lat": 58.410417, "lon": 15.619667, "pop": 102945},
    ],
    "FI": [
        {"name": "Helsinki", "lat": 60.169856, "lon": 24.938379, "pop": 656873},
        {"name": "Espoo", "lat": 60.205252, "lon": 24.655899, "pop": 288975},
        {"name": "Tampere", "lat": 61.494912, "lon": 23.760701, "pop": 239316},
        {"name": "Vantaa", "lat": 60.294167, "lon": 25.037222, "pop": 233257},
        {"name": "Turku", "lat": 60.452788, "lon": 22.266626, "pop": 190667},
        {"name": "Oulu", "lat": 65.012662, "lon": 25.475171, "pop": 156214},
        {"name": "Kuopio", "lat": 62.891111, "lon": 27.678333, "pop": 123372},
        {"name": "Jyväskylä", "lat": 62.242531, "lon": 25.748151, "pop": 143341},
    ],
    "DK": [
        {"name": "Copenhagen", "lat": 55.676111, "lon": 12.568333, "pop": 1349000},
        {"name": "Aarhus", "lat": 56.156667, "lon": 10.200000, "pop": 349983},
        {"name": "Odense", "lat": 55.403333, "lon": 10.388889, "pop": 175245},
        {"name": "Aalborg", "lat": 57.047857, "lon": 9.921682, "pop": 131916},
        {"name": "Randers", "lat": 56.461667, "lon": 10.316667, "pop": 101564},
    ],
    "SK": [
        {"name": "Bratislava", "lat": 48.148598, "lon": 17.107748, "pop": 475508},
        {"name": "Košice", "lat": 48.718333, "lon": 21.260833, "pop": 236093},
        {"name": "Prešov", "lat": 49.000000, "lon": 21.239167, "pop": 106648},
        {"name": "Žilina", "lat": 49.224167, "lon": 18.740833, "pop": 109618},
        {"name": "Banská Bystrica", "lat": 48.735833, "lon": 19.140278, "pop": 77229},
    ],
    "SI": [
        {"name": "Ljubljana", "lat": 46.056947, "lon": 14.505751, "pop": 295022},
        {"name": "Maribor", "lat": 46.553329, "lon": 15.647834, "pop": 111385},
        {"name": "Celje", "lat": 46.238889, "lon": 15.277222, "pop": 49323},
    ],
    "HR": [
        {"name": "Zagreb", "lat": 45.815011, "lon": 15.982287, "pop": 769944},
        {"name": "Split", "lat": 43.508137, "lon": 16.440808, "pop": 176314},
        {"name": "Rijeka", "lat": 45.327063, "lon": 14.442176, "pop": 128735},
        {"name": "Osijek", "lat": 45.551667, "lon": 18.713889, "pop": 108048},
    ],
    "LT": [
        {"name": "Vilnius", "lat": 54.687157, "lon": 25.279652, "pop": 588412},
        {"name": "Kaunas", "lat": 54.901389, "lon": 23.904444, "pop": 324365},
        {"name": "Klaipėda", "lat": 55.708889, "lon": 21.144722, "pop": 151177},
        {"name": "Šiauliai", "lat": 55.933889, "lon": 23.728889, "pop": 104697},
    ],
    "LV": [
        {"name": "Riga", "lat": 56.949649, "lon": 24.105186, "pop": 605802},
        {"name": "Daugavpils", "lat": 55.873611, "lon": 26.532500, "pop": 102325},
        {"name": "Liepāja", "lat": 56.515000, "lon": 21.015000, "pop": 76731},
    ],
    "EE": [
        {"name": "Tallinn", "lat": 59.436961, "lon": 24.753575, "pop": 438203},
        {"name": "Tartu", "lat": 58.378025, "lon": 26.728123, "pop": 140232},
        {"name": "Narva", "lat": 59.378889, "lon": 28.187500, "pop": 58385},
    ],
    "CY": [
        {"name": "Nicosia", "lat": 35.126413, "lon": 33.382827, "pop": 310968},
        {"name": "Limassol", "lat": 34.674882, "lon": 33.038252, "pop": 193100},
        {"name": "Larnaca", "lat": 34.917671, "lon": 33.630033, "pop": 69920},
    ],
    "LU": [
        {"name": "Luxembourg City", "lat": 49.611621, "lon": 6.129583, "pop": 128025},
        {"name": "Esch-sur-Alzette", "lat": 49.493889, "lon": 5.978056, "pop": 100816},
    ],
    "MT": [
        {"name": "Valletta", "lat": 35.897656, "lon": 14.512516, "pop": 6000},
        {"name": "Birkirkara", "lat": 35.871667, "lon": 14.402500, "pop": 121910},
        {"name": "Mosta", "lat": 35.880556, "lon": 14.378889, "pop": 20107},
    ],
    "BG": [
        {"name": "Sofia", "lat": 42.697708, "lon": 23.321868, "pop": 1241396},
        {"name": "Plovdiv", "lat": 42.149833, "lon": 24.750680, "pop": 346893},
        {"name": "Varna", "lat": 43.204808, "lon": 27.911856, "pop": 312770},
        {"name": "Burgas", "lat": 42.504810, "lon": 27.471111, "pop": 210385},
        {"name": "Ruse", "lat": 43.852222, "lon": 25.955000, "pop": 155049},
    ],
    "IE": [
        {"name": "Dublin", "lat": 53.349805, "lon": -6.260310, "pop": 1256057},
        {"name": "Cork", "lat": 51.897720, "lon": -8.470027, "pop": 208669},
        {"name": "Galway", "lat": 53.271028, "lon": -9.050582, "pop": 179227},
        {"name": "Limerick", "lat": 52.638889, "lon": -8.624444, "pop": 100396},
    ],
}

def get_nearest_city(lat: float, lon: float, max_distance: float = 200.0) -> Optional[Dict[str, Any]]:
    """
    Find nearest city (100k+ population) within max_distance km.
    
    Args:
        lat: Latitude of site
        lon: Longitude of site
        max_distance: Maximum search distance in km (default 200)
    
    Returns:
        Dict with city name and distance, or None if not found
    """
    import math
    
    def haversine(lat1, lon1, lat2, lon2):
        R = 6371.0088
        phi1 = math.radians(lat1)
        phi2 = math.radians(lat2)
        dphi = math.radians(lat2 - lat1)
        dlambda = math.radians(lon2 - lon1)
        a = math.sin(dphi/2)**2 + math.cos(phi1) * math.cos(phi2) * math.sin(dlambda/2)**2
        c = 2 * math.atan2(math.sqrt(a), math.sqrt(1-a))
        return R * c
    
    nearest = None
    nearest_dist = float('inf')
    
    for country_code, cities in EU_CITIES_DB.items():
        for city in cities:
            dist = haversine(lat, lon, city["lat"], city["lon"])
            if dist < nearest_dist and dist <= max_distance:
                nearest_dist = dist
                nearest = {"name": city["name"], "distance_km": dist}
    
    return nearest if nearest else None
